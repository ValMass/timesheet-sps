<div class="modal-container">
  <div class="">
    <h1 mat-dialog-title>Aggiungi evento</h1>
    <h6 class="text-danger" *ngIf="aggiungiButtonDisabled" mat-dialog-title>{{errorMessage}}</h6>
  </div>
  <div mat-dialog-content>
    <form id='myform' class="p-1" [formGroup]="profileForm" (ngSubmit)="submit()">

      <div class="input-group">
        <label>Data</label>
        <!--<label for="dataevento">Data</label>-->
        <div>
        <input class="form-control input-number text-center mb-4" matInput [matDatepicker]="picker" #ref required
          (dateChange)="onDateChange($event)" formControlName="eventDate" [ngClass]="{'is-invalid': f.eventDate.errors && submitted}" style="width: 200px;">

        </div>
        <mat-datepicker-toggle matSuffix [for]="picker" class="bottone-data"></mat-datepicker-toggle>
        <div *ngIf="f.eventDate.errors && submitted" style="color: red; position:relative; right:200px; ">Campo obbligatorio</div><br>
        <mat-datepicker #picker></mat-datepicker>
      </div>


      <div class="mb-2">
        <label for="cars" class="cod-contratto">Codice contratto</label>
        <select id="cars" name="cars" class="custom-select sel-text" formControlName="contractCode"
        [ngClass]="{'is-invalid':f.contractCode.errors && submitted}"
          (change)="onChangeSelect($event)" required>
          <option value="LAVORO" selected="selected">Lavoro ordinario</option>
          <option value="SEDE">Attività interna</option>
          <option value="PERMNON">Permesso non retribuito</option>
          <option value="PERMESS">Permesso generico</option>
          <option value="MALATT">Malattia</option>
          <option value="LUTTO">Lutto parente primo grado</option>
          <option value="AVIS">Donazione sangue</option>
          <option value="FERIE">Ferie</option>
          <option value="MATALA">Allattamento</option>
          <option value="ASPETT">Aspettativa</option>
          <option value="ELETTO">Permesso elettorale</option>
          <option value="FESTSOP">Festivita soppresse</option>
          <option value="MATERN">Maternita</option>
          <option value="MATFAC">Maternita facoltativa</option>
          <option value="MALFIG">Malattia figlio</option>
          <option value="MATRIMO">Matrimonio</option>
          <option value="PARTIME">Tempo parziale</option>
          <option value="PATRONO">Patrono</option>
          <option value="UNIVERS">Assenza esami universitari</option>
        </select>
        <div *ngIf="f.contractCode.errors && submitted" style="color: red;">Campo obbligatorio</div>
      </div>

      <div *ngIf="insertLavoro">
          <div class="mb-3">
            <label for="customRange3" class="col-form-label">Numero ore</label> {{ value }}
            <input type="number" class="form-control input-number" value="8" min="0" max="12" step="1" id="customRange3"
              required formControlName="numeroOre" (input)="valueChanged($event)">
          </div>
        <div class="mb-2">
          <label for="cod-fatturazione" class="cod-fatturazione">Codice Fatturazione</label>
          <select id="cod-fatturazione" name="cod-fatturazione" class="custom-select sel-text"
            [ngClass]="{'is-invalid':f.codiceFatturazione.value === '00' && submitted}"
            formControlName="codiceFatturazione" (change)="onChangeFattSelect($event)" required>
            <option value="01">Ore ordinarie fatturabili</option>
            <option value="02">Ore straordinarie fatturabili</option>
            <option value="03">Ore straordinarie festive fatturabili</option>
            <option value="04">Ore straordinarie notturne fatturabili</option>
            <option value="NF">Non fatturabili</option>
            <option value="RP">Ore di reperibilità</option>
            <option value="IN">Ore di intervento</option>
            <option value="TR">Trasferta</option>
          </select>
          <div *ngIf="f.codiceFatturazione.value === '00' && submitted" style="color: red;" >Campo obbligatorio</div>
        </div>
        
        <div class="mb-2">
          <label for="customerId" class="col-form-label">Cliente</label>
          <div>
            <ng-select [items]="customerList" bindLabel="name" formControlName="customerId" bindValue="id"
            [ngClass]="{'error':f.customerId.errors  && submitted}">
            </ng-select>
          </div>
          <div *ngIf="f.customerId.errors && submitted" style="color: red;">Campo obbligatorio</div>
        </div>
        
        <div class="mb-2">
          <label for="activityId" class="col-form-label">Attività</label>
          <div>
            <ng-select [readonly]="!assignedact" [items]="assignedact" bindLabel="name" formControlName="activityId" bindValue="id" 
            [ngClass]="{'error':(f.activityId.value === '0' || f.activityId.value === null) && submitted}">
            </ng-select>
          </div>
          <div *ngIf="(f.activityId.value === '0'  || f.activityId.value === null) && submitted" style="color: red;">Campo obbligatorio</div>
        </div>
        
        <div class="mb-2">
          <mat-checkbox class="example-margin" formControlName="smartWorking"
            labelPosition="before">
            Smart Working
          </mat-checkbox>

        </div>
      </div>

      <div *ngIf="insertMalattia">
        <div class="mb-2">
          <label for="numeroprotocollo" class="col-form-label">Numero protocollo</label>
          <input type="text" class="form-control input-number" id="numProtocollo" placeholder="Numero protocollo"
            [ngClass]="{'is-invalid':f.numProtocollo.value === '00' && submitted}" formControlName="numProtocollo" />
          <div *ngIf="f.numProtocollo.value === '00' && submitted" style="color: red;">Campo obbligatorio</div>
        </div>
      </div>

      <div *ngIf="insertNumeroOre">
        <div class="mb-2">
          <label for="customRange3" class="col-form-label">Numero ore</label> {{ value }}
          <input type="number" class="form-control input-number" value="8" min="0" max="12" step="1" id="customRange3"
            required formControlName="numeroOre" (input)="valueChanged($event)"
            [ngClass]="{'is-invalid':(f.numeroOre.value == 0 || f.numeroOre.value == null) && submitted}">
          <div *ngIf="(f.numeroOre.value == 0 || f.numeroOre.value == null) && submitted" style="color: red;">Campo obbligatorio</div>
        </div>
      </div>
    </form>

  </div>
  <div class="d-flex justify-content-between" mat-dialog-actions>
    <button type="button" mat-button mat-dialog-close class="btn btn-custom w-25" (click)="close()">Close</button>
    <button  form='myform' type="submit" class="btn btn-custom w-25">Aggiungi</button>
  </div>
</div>
